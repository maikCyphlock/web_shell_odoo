<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">
    <t t-name="web_shell.Console" owl="1">
        <div class="o_web_shell_container d-flex flex-column h-100">
            <div class="d-flex flex-grow-1 h-100" style="height: 0;">
                <!-- Left: Terminal -->
                <div class="o_shell_left d-flex flex-column">
                    <!-- Output History -->
                    <div class="o_shell_output" t-ref="outputRef">
                        <t t-foreach="state.history" t-as="line" t-key="line_index">
                            <div t-if="line.type === 'input'" class="o_history_input">
                                <span class="o_prompt">&gt;&gt;&gt;</span>
                                <code t-out="line.highlighted"/>
                            </div>
                            <div t-if="line.type === 'output'" class="o_history_output">
                                <t t-esc="line.text"/>
                                <div t-if="line.audit" class="o_audit_info d-flex gap-2 mt-1 small opacity-75">
                                    <span title="SQL Queries" class="badge rounded-pill bg-dark border border-secondary text-info">
                                        <i class="fa fa-database me-1"></i><t t-esc="line.audit.queries"/> q
                                    </span>
                                    <span title="Execution Time" class="badge rounded-pill bg-dark border border-secondary text-warning">
                                        <i class="fa fa-clock-o me-1"></i><t t-esc="Math.round(line.audit.time_ms)"/>ms
                                    </span>
                                    <span t-if="line.audit.todo_fields &amp;&amp; line.audit.todo_fields.length > 0" 
                                          title="Computed fields triggered" 
                                          class="badge rounded-pill bg-dark border border-secondary text-success">
                                        <i class="fa fa-magic me-1"></i><t t-esc="line.audit.todo_fields.length"/> fields
                                    </span>
                                </div>
                            </div>
                            <div t-if="line.type === 'error'" class="o_history_error">
                                <t t-esc="line.text"/>
                            </div>
                        </t>
                    </div>

                    <!-- Input Area with Ace Editor -->
                    <div class="o_input_wrapper">
                        <div class="o_input_header d-flex justify-content-between align-items-center">
                            <span>üöÄ CTRL+Shift+ENTER para ejecutar | TAB para indentar | CTRL+‚Üë‚Üì para historial | Ace Editor</span>
                            <div class="form-check form-switch me-2">
                                <input class="form-check-input" type="checkbox" id="safeModeSwitch" t-model="state.safeMode"/>
                                <label class="form-check-label text-warning fw-bold" for="safeModeSwitch">
                                    üõ°Ô∏è Safe Mode
                                </label>
                            </div>
                        </div>
                        <div class="o_ace_editor" t-ref="editorRef"></div>
                    </div>
                </div>

                <!-- Right: Log Viewer -->
                <div class="o_shell_right d-flex flex-column border-start border-secondary">
                    <!-- Tabs Header -->
                    <div class="d-flex border-bottom border-dark bg-dark">
                
                        <button class="btn btn-sm flex-grow-1 rounded-0 py-2" 
                            t-att-class="state.activeRightTab === 'debug' ? 'btn-secondary text-white' : 'btn-dark text-muted'"
                            t-on-click="() => this.state.activeRightTab = 'debug'">
                            <i class="fa fa-bug"></i> DEBUG TOOLS
                        </button>
                    </div>

                    
                    <!-- Debug Tools View -->
                    <t t-if="state.activeRightTab === 'debug'">
                        <DebugTools />
                    </t>
                </div>
            </div>
        </div>
    </t>
</templates>
